# SQL 开发

## 规范优雅

### 1. 避免数据类型的隐式转换

隐式转换会导致索引失效，如:
```sql
select name,phone from customer where id = '111';
```

### 2. WHERE 从句中禁止对列进行函数转换和计算

对列进行函数转换或计算时会导致索引失效，如:
```sql
where date(create_time)='20190101'
```
推荐：
```sql
where create_time >= '20190101' and create_time < '20190102'
```

###  3. 禁止使用 SELECT * 查询

原因：
- 消耗更多的 CPU 和 IO 以网络带宽资源
- 无法使用覆盖索引
- 可减少表结构变更带来的影响

### 4. 设计表的时候，所有表和字段都添加相应的注释

这个好习惯一定要养成啦，设计数据库表的时候，所有表和字段都添加相应的注释，后面更容易维护。

### 5. 尽量把所有列定义为NOT NULL

- 「NOT NULL列更节省空间」，NULL列需要一个额外字节作为判断是否为 NULL 的标志位。
- 「NULL列需要注意空指针问题」，NULL列在计算和比较的时候，需要注意空指针问题。

### 6. 如果修改字段含义或对字段表示的状态追加时，需要及时更新字段注释。

这个点，是阿里开发手册中，Mysql的规约。你的字段，尤其是表示枚举状态时，如果含义被修改了，或者状态追加时，为了后面更好维护，需要即时更新字段的注释。

## 性能优化

### 1. 写完SQL先explain查看执行计划

日常开发写SQL的时候，尽量养成这个好习惯呀：写完SQL后，用explain分析一下，尤其注意走不走索引。

### 2. 写完SQL语句，检查where,order by,group by后面的列，多表关联的列是否已加索引，优先考虑组合索引。

### 3. 尽量使用varchar代替 char

- 因为首先变长字段存储空间小，可以节省存储空间。
- 其次对于查询来说，在一个相对较小的字段内搜索，效率更高。
    