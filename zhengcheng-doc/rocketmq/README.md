# RocketMQ 的设计理念和目标

## 设计理念

RocketMQ 设计基于主题的发布订阅模式，其核心功能包括消息发送、消息存储（Broker）、消息消费，整体设计追求简单和性能第一，主要体现在如下三个方面。

首先，`NameServer`设计极其简单，摒弃了`Zookeeper`充当注册中心,采用自研`NameServer`实现元数据的管理(Topic路由信息等)，**追求最终一致性，并且能容忍分钟级的不一致**。
正式基于此种情况，**RocketMQ的`NameServer`集群间互不通信**，极大地降低了`NameServer`实现的复杂程度，对网络的要求也降低不少，性能相对于`Zookeeper`有较大提升。

其次，是高效的IO存储机制。RocketMQ 追求消息发送的高吞吐量，消息存储文件设计成**文件组**的概念，组内单个文件大小固定，方便引入**内存映射机制**，所有主题的消息存储基于**顺序写**，
极大地提升了消息写性能，同时为了兼顾消息消费与消息查找，引入了**消息消费队列文件**与**索引文件**

最后，容忍存在设计缺陷，RocketMQ 只保证消息被消费者消费，但设计上允许消息被重复消费，这样极大地简化了消息中间件的内核，使得实现消息发送高可用变得非常简单与高效，
**消息重复问题由消费者在消息消费时实现幂等**。

